<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add Anime to GitHub</title>
</head>
<body>
  <h2>Add New Anime</h2>
  <form id="animeForm">
    <label>Title:</label>
    <input type="text" id="title" required><br>

    <label>Image Link:</label>
    <input type="text" id="image" required><br>

    <label>Page Link:</label>
    <input type="text" id="link" required><br>

    <button type="submit">Upload</button>
  </form>

  <script>
    const username = "rdsteam18";
    const repo = "NETLIFY";
    const token = "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";
    const branch = "main";

    document.getElementById("animeForm").addEventListener("submit", async function (e) {
      e.preventDefault();

      const title = document.getElementById("title").value.trim();
      const image = document.getElementById("image").value.trim();
      const link = document.getElementById("link").value.trim();

      const filename = `${title.replace(/\s+/g, "_")}.html`;

      const htmlContent = `
<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8"><title>${title}</title></head>
<body>
  <h1>${title}</h1>
  <img src="${image}" alt="${title}" style="max-width:300px;"><br>
  <a href="${link}" target="_blank">Watch Now</a>
</body>
</html>`.trim();

      const content = btoa(unescape(encodeURIComponent(htmlContent)));

      const response = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/${filename}`, {
        method: "PUT",
        headers: {
          "Authorization": `Bearer ${token}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          message: `Add file: ${filename}`,
          content: content,
          branch: branch
        })
      });

      if (response.ok) {
        alert(`✅ File '${filename}' uploaded successfully!`);
        document.getElementById("animeForm").reset();
      } else {
        const error = await response.json();
        alert("❌ Error: " + error.message);
        console.error(error);
      }
    });
  </script>
</body>
</html>
